# Maintainer: Samir Benmendil <ram-z[at]chakra-project[dot]org>
# Contributor: aur2ccr (http://ddg.gg/?q=!ccr+aur2ccr&t=chakra)
# Contributor: Linus Sj√∂gren <thelinx@unreliablepollution.net>
pkgname=lua-penlight
pkgver=1.3.1
pkgrel=1
pkgdesc="Lua libraries focusing on input data handling"
license=('custom')
arch="any"
url="https://github.com/stevedonovan/Penlight"
depends=('lua' 'lua-filesystem')
source=("$pkgname-$pkgver.tar.gz::$url/archive/$pkgver.tar.gz")
md5sums=('831f8ce7d3d5c872d129ad5db54a8424')

check() {
  cd Penlight-$pkgver
  export LUA_PATH="$PWD/lua/?/init.lua;$PWD/lua/?.lua;$(lua -e 'print(package.path)')"
  lua run.lua
}

build() {
  cd Penlight-$pkgver
  install -dm755 "$pkgdir/usr/share/lua/5.1/pl"
  install -m644 lua/pl/* "$pkgdir/usr/share/lua/5.1/pl"
  # copy docs
  install -dm755 "$pkgdir/usr/share/doc/$pkgname/"{,manual,examples}
  install -m644 CONTRIBUTING.md CHANGES.md README.md "$pkgdir/usr/share/doc/$pkgname"
  install -m644 doc/manual/* "$pkgdir/usr/share/doc/$pkgname/manual"
  install -m644 examples/* "$pkgdir/usr/share/doc/$pkgname/examples"
  # copy license
  install -Dm644 LICENSE.md "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}
