# Maintainer: Samir Benmendil <ram-z[at]chakra-project[dot]org>
# Contributor: aur2ccr (http://ddg.gg/?q=!ccr+aur2ccr&t=chakra)
pkgdesc="ROS - Package Tool"
url='http://www.ros.org/'
_package="turtlebot_apps"
_release="groovy"

pkgname="ros-groovy-${_package}"
pkgver='1.7.1'
arch=('i686' 'x86_64')
pkgrel=1
license=('BSD')
makedepends=('ros-build-tools')
source=("${pkgname}::git+https://github.com/turtlebot/${_package}.git#branch=${_release}")
md5sums=('SKIP')
depends=(
  ros-groovy-catkin
  ros-groovy-actionlib-msgs
  python2
  pkg-config)

build() {
  [ -f /opt/ros/groovy/setup.bash ] && source /opt/ros/groovy/setup.bash
  cd "${pkgname}"
  /usr/share/ros-build-tools/fix-python-scripts.sh ${srcdir}/${pkgname}
  apps=(turtlebot_actions turtlebot_core_apps turtlebot_navigation turtlebot_sounds
        turtlebot_calibration turtlebot_follower turtlebot_panorama turtlebot_teleop)
  apps=(turtlebot_teleop)
  for app in ${apps[@]}; do
      cd "$app"
      msg "Building $app"
      cmake . -DCMAKE_INSTALL_PREFIX=/opt/ros/groovy -DPYTHON_EXECUTABLE=/usr/bin/python2
      make
      cd ..
  done
}

package() {
  cd "${pkgname}"
  make DESTDIR="${pkgdir}/" install
}
